
## 배포
- **배포**
	jcgf는 비교적 쉽게 배포하지만 happycode는 비즈니스 로직이 들어있어서 꼼꼼히 보고 배포함. 주로 정기점검 때 배포. 플랫폼 쪽에 꼭 미리 공유!
	백엔드 소스 수정은 최소 점검일(목) 하루 전에 머지 요청이 들어가야함!
	ex) 8일(머지) 9일(목/점검) 10일오픈
	
	- 배포과정 : 소스수정 ㅡPull Request(마스터요청)→ Master (머지권한 : 이사님/대열팀장님) ㅡ컨펌→ Mergy → 젠킨스 → 세팅→ 파이프 → 4개서버 순차배포
	
	- 배포/운영도 우리가 하긴하는데, 재승PM님이 하는 것 같이 되어있음(계정 받아 처리)

## 서버
- **서버**
1) 대만 Azure
2) 일본 ncloud(최근 이전)
3) ~~태국 (소스만 남아있음)

## 소스명칭
- **소스 명칭**
1) jcgf (front) : a.k.a. **web** 
2) happycode (back) : a.k.a. **web-API**
	특이사항 : happycode 소스를 게임 서버와 L7에서도 같이 씀!
			게임쪽에서 쓰는 happycode는 **Game API** 라고 부름

## 운영업무

- **운영 업무**
	- **쿠폰**
		- 쿠폰 table(아무나 받게/특정유저만 받게 옵션 선택 : 잘못작성했으면 지우고 다시 만들기) → 프로모션 tb → 아이템 바인드 → 아이템 tb
		어뷰징(?)
	
	- **충전**
		- Mycard로 충전됨.
		- 결재 ㅡ(콜백)→ 월렛(전자지갑 tb)→ charge tb(히스토리 저장)
		 결재된 캐시로 플랫폼 to 아바or거상... 게임으로 캐시저장/변환 가능. but 게임 to 플랫폼으로는 변환 불가.
		- mycard에서 결재 리다이렉트 넘어간 후로는 테스트가 안되기 때문에 체크가능 영역이 한정적.
	 
	- **웹몰**
		- 웹몰, 가챠 모두 게임마다 유무가 다름 / 웹몰 유 : 오디션, 거상, SF1(오픈연기)
		- 월렛 충전 후 웹몰에서 쇼핑이 가능함.
		- 웹몰 ↔ (백엔드) GameSender.groovy ↔ 게임마다 아이템 전달 ↔ 게임DB(유저, 아이템 / 게임마다 DB가 다름) / 로그(web:API, 카탈리나, log4j 사용)
		- 광군제(11/11) 웹몰이벤트(11/9~11) 매년 기획팀에서. 윤서님 주로 진행
	
	- **가챠**
		- 가챠 유 : 거상, SF1
		- 페이지 ↔ web 가챠 컨트롤러 ↔ web-API / 가챠 API 컨트롤러 ↔ game sender API ↔ DB



***

## 모니터링

- 주로 scouter tool 사용 / tomcat 체크함
-  서버(tomcat) → 크론탭(메모리 사용률 / 디스크사용률 90% 오버시 체크) → 분단위 → 프로세스 체크 → push 알람
- 서버(tomcat) → scouter(톰캣 실행과 같이 나옴) → puch (tomcat 셧다운시 알람 / 팀-개발팀-일반으로 날라옴)


---

## 인프라

- QA쪽 IP를 주로 본다고 생각~ 10.100.100.5
- Dmode TEST(dev용) / live(production)
- 메일확인
- 로그인 session : Tomcat에서 Redis.jar 있음 / context.xml에서 레디스 가져옴

#grails_이슈
- Grails는 메모리 많이 찼다고 그냥 kill되기도 함.
ex) 서버(트래픽) 최소 3000 ~ (좀 많음? 8천) ~ 최대 4만
- 가챠(DB랑 많이 왔다갔다해서) 또는 공격들어갈 때 많이 죽어요

- 런처 : A.exe / 껍데기 : C#, 내부 : web 웹뷰
- 매월 첫째주 목요일 : 캐시 리셋 / 월배치 작업

### 💌 [인프라 Figma](https://www.figma.com/file/XCbDcwApZZCoJVeZM6bFpa/Flow?type=whiteboard&node-id=0-1&t=hVrK15lS2tB4otVi-0)

![[Pasted image 20240508111211.png]]

![[Pasted image 20240508111301.png]]

![[Pasted image 20240508111408.png]]

![[Pasted image 20240508111438.png]]

## 런처

- happytuk.exe는 이사님이 핸들링
- #C 페이지는 IE로 무조건 넘어감
- 크롬/엣지 크로스사이트 체크해야함~
- 런처페이지 도메인 설정은 재승PM님이
- 웹) 템플릿 1이 가장 최근 
- 모바일) 102 or 105가 기본템플릿
- CDN은 게임명으로 분류가 주로 되어있음!


## 업무처리

-기획팀에서 온 결재서류 중 데이터추출건 중 플랫폼 DB를 많이 작업 (게임쪽은 각 회사로 ㄱ)


## 조직도

- 영업팀 / 사업팀 - 달리아이사님(대표님 직속)
- 개발팀 Jeff 이사님 → 개발팀 오더 (한국개발팀 == 플랫폼팀 == 우리팀)
- 시스템팀 : 게임 서버 관리
- 디자인팀 : 퍼블리싱
- ...

- 게임 서버 장애시 대응팀은 따로 없음. 한국개발팀에서 처리하는 경우 많음



## 캐시

1. **CDN** - 정적 파일(HTML, css, js 등등) 을 naver cdn 에서 각 리전별 cache 를 하여 응답을 보내며 수정이 발생 시 purge 작업을 한다.  
    개발자가 특별히 신경 쓸 부분은 없다.
    
2. **Memcache** - 각각의 frontEnd(JCGF)에 local cache 용도로 사용되며 backend 호출량을 줄이기 위하여(1분 정도) 잦은 호출이 발생하는 page는 Memcache 를 사용하여 호출 빈도를 줄인다.
    
3. **Redis** - Azure Redis 를 공통적으로 사용하며 각서버에서 동일한 변수 사용 혹은 session 정보 저장 용도로 사용되고 있다.

![[Items.png]]


